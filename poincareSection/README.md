# 利用 numpy 的常微分方程模拟和可视化

## 常微分方程模拟

一般的, 数学中的常微分方程拥有形式:

$$
\frac {\textrm{d} x} {\textrm{d} t} = f(x, t).
$$

其中变量 $x$ 描述研究对象在相空间的位置, 换言之也正是其状态, 函数 $f$ 描述了它在相空间中的流场, 而对象的运动也就是其在流场中沿着流线运动.

通常严格求解微分方程是困难的, 我们使用4阶 Runge-Kutta 方法进行模拟, 它将轨迹在离散时间 $t_n$ 的取值给出近似估计

$$
\begin{aligned}
x_{n+1} &= x_n + \frac 1 6 h (k_1 + 2k_2 + 2k_3 + k_4) \\
t_{n+1} &= t_n + h
\end{aligned}
$$

其中诸项

$$
\begin{aligned}
k_1 &= f(x_n, t_n) \\
k_2 &= f(x_n + h k_1/2, t_n + h/2) \\
k_3 &= f(x_n + h k_2/2, t_n + h/2) \\
k_4 &= f(x_n + hk_3, t_n + h)
\end{aligned}
$$

RK4 方法的累积误差在 $\mathcal{O}(h^4)$. 

## Poincare 截面

一个动力系统的 Poincare 截面, 简单来讲是截取了一组相轨迹的低维面. 为了可视化的方便, 我们通常会选择一个二维平面来实现它. 

在相空间定义平面 $\Pi$, 追踪从一个固定点出发的相轨迹, 每当它从面的一侧穿过进入另一侧, 它和 $\Pi$ 的交点便被记录下来. 长时间之后这些点画出的图像就被称为动力系统从给定起点出发的 Poincare 映射. 遍历起点将给我们展示动力系统周期轨道的稳定性, 同样也可以定性地分析动力学的混沌性与否. 